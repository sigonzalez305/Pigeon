<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pigeon MSG</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="app-shell">
    <header class="app-header">
      <div class="logo-block">
        <div class="pigeon-icon" aria-hidden="true">üïäÔ∏è</div>
        <div>
          <p class="eyebrow">PIGEON MSG</p>
          <h1 class="headline">Cozy pigeon care, Tamagotchi style.</h1>
          <p class="subhead">Start in the coop, style your bird, then hop into the chatty message flow.</p>
        </div>
      </div>
      <div class="level-card">
        <div class="level-top">
          <div>
            <p class="label">Pigeon Level</p>
            <p id="pigeonLevel" class="metric">1</p>
          </div>
          <button id="dailyReset" class="tiny reset" type="button" title="Testing only: clears the one-message-per-day limit">reset</button>
        </div>
        <p class="label">XP</p>
        <div class="meter" aria-label="Experience">
          <div id="xpBar" class="meter-fill" style="width: 5%"></div>
        </div>
        <p id="xpText" class="tiny">0 / 20 XP</p>
        <p class="tiny reset-note">Testing reset clears the daily limit only. Coop, XP, badges, and history are safe.</p>
      </div>
    </header>

    <nav class="tab-nav" aria-label="Primary">
      <button class="tab-button is-active" data-screen-button="coop">Pigeon Coop</button>
      <button class="tab-button" data-screen-button="message">Message</button>
      <button class="tab-button" data-screen-button="history">History</button>
    </nav>

    <section class="coop" aria-labelledby="coop-title" data-screen="coop">
      <div>
        <p id="coopTitle" class="section-title">Pigeon Coop</p>
        <p class="section-copy">Name your pigeon, pick its vibe, and preview its current gear.</p>
        <div class="coop-controls" id="coopControls" aria-live="polite">
          <div class="input-block readonly-block">
            <div class="label-row">
              <span class="label">Pigeon Name</span>
              <button id="editCoop" class="tiny" type="button">Edit</button>
            </div>
            <input id="pigeonName" type="text" maxlength="20" placeholder="Sky Courier" disabled />
          </div>
          <div class="input-block readonly-block">
            <div class="label-row">
              <span class="label">Signature Color</span>
            </div>
            <select id="pigeonColor" disabled>
              <option value="silver">Silver</option>
              <option value="gold">Gold</option>
              <option value="indigo">Indigo</option>
              <option value="rose">Rose</option>
            </select>
          </div>
        </div>
        <div class="pet-row">
          <button id="petPigeon" class="button button-secondary" type="button">Pet</button>
          <button id="feedPigeon" class="button button-secondary" type="button">Give Snack</button>
          <span id="pigeonMood" class="tiny" aria-live="polite">Your pigeon looks curious.</span>
        </div>
        <button class="button coop-cta" type="button" data-screen-button="message">Select pigeon & compose</button>
      </div>
      <div class="pigeon-preview" aria-label="Current pigeon preview">
        <figure class="pigeon-figure">
          <img id="pigeonSprite" class="pigeon-graphic" src="assets/tamagotchi-pigeon.svg" alt="Pixel pigeon with a heart speech bubble" />
        </figure>
        <p class="badge-tag" id="pigeonAccessoryLabel">Tamagotchi Buddy Pack</p>
      </div>
    </section>

    <section class="panel message-panel" aria-labelledby="message-title" data-screen="message" hidden>
      <div class="panel-header">
        <p id="message-title" class="section-title">Message of the Day</p>
        <p class="section-copy">A WhatsApp-style chat view to share one thoughtful note. Check the skies, then launch.</p>
      </div>
      <div class="message-layout">
        <div class="chat-window" id="chatWindow" aria-live="polite"></div>
        <form id="messageForm" class="form-grid chat-composer">
          <div class="dual-input">
            <label class="input-block">From Phone (US only)
              <input id="fromPhone" type="tel" inputmode="tel" maxlength="14" placeholder="2125551234" />
            </label>
            <label class="input-block">To Phone (US only)
              <input id="toPhone" type="tel" inputmode="tel" maxlength="14" placeholder="4155556789" />
            </label>
          </div>
          <div class="dual-input">
            <div class="input-block">
              <span class="label">From region</span>
              <p id="fromRegion" class="metric tiny-block">Waiting for area code‚Ä¶</p>
            </div>
            <div class="input-block">
              <span class="label">To region</span>
              <p id="toRegion" class="metric tiny-block">Waiting for area code‚Ä¶</p>
            </div>
          </div>
          <label class="input-block">Purpose
            <select id="purpose">
              <option value="Encouragement">Encouragement</option>
              <option value="Love">Love</option>
              <option value="Update">Update</option>
              <option value="Thank You">Thank You</option>
            </select>
          </label>
          <label class="input-block full">Message
            <textarea id="message" rows="4" maxlength="220" required placeholder="Share one thoughtful note for today."></textarea>
          </label>
          <div class="weather-inline full">
            <div>
              <p class="label">Weather</p>
              <p id="weatherSummary" class="metric">Waiting for forecast‚Ä¶</p>
              <p id="weatherImpact" class="tiny">Check both area codes to see the impact.</p>
            </div>
            <button id="checkWeather" class="button button-secondary hidden" type="button">Check Weather</button>
          </div>
          <div class="eta-row full">
            <p id="etaText" class="tiny">ETA will appear after weather check (1‚Äì5 minutes).</p>
            <p id="dailyStatus" class="tiny">Ready to fly.</p>
          </div>
          <div class="form-actions full">
            <button type="submit" class="button">Launch Pigeon</button>
          </div>
        </form>
      </div>
    </section>

    <section class="panel journey-panel" aria-labelledby="journey-title">
      <div class="panel-header">
        <p id="journey-title" class="section-title">Flight Map & Journey</p>
        <p class="section-copy">An 8-bit map animates your pigeon‚Äôs path after each launch.</p>
      </div>
      <div class="map-wrapper">
        <div class="pixel-map">
          <svg id="flightMap" viewBox="0 0 800 480" role="presentation">
            <defs>
              <linearGradient id="sky" x1="0" x2="1" y1="0" y2="1">
                <stop offset="0%" stop-color="#1c2541" />
                <stop offset="100%" stop-color="#0b132b" />
              </linearGradient>
            </defs>
            <rect width="800" height="480" rx="12" fill="url(#sky)" />
            <g id="mapGrid" stroke="#2b3957" stroke-width="1" opacity="0.25"></g>
            <g id="usOutline" fill="#14213d" stroke="#2b3957" stroke-width="3" opacity="0.9"></g>
            <path id="flightPath" d="" fill="none" stroke="#67f3a5" stroke-width="4" stroke-dasharray="6 10" opacity="0.7" />
            <circle id="fromMarker" r="8" fill="#67f3a5" stroke="#0b0f1a" stroke-width="3" />
            <circle id="toMarker" r="8" fill="#5db0ff" stroke="#0b0f1a" stroke-width="3" />
            <text id="fromLabel" class="map-label" x="0" y="0">FROM</text>
            <text id="toLabel" class="map-label" x="0" y="0">TO</text>
            <g id="flightSprite" class="flight-icon" aria-hidden="true">
              <text x="0" y="0" font-size="26">üïäÔ∏è</text>
            </g>
          </svg>
        </div>
        <div class="journey-stats">
          <div class="stat-card">
            <p class="label">Miles Flown</p>
            <p id="milesFlown" class="metric">0</p>
            <p class="tiny">Longer trips unlock badges.</p>
          </div>
          <div class="stat-card">
            <p class="label">Badges</p>
            <div id="badgeList" class="badge-row" aria-live="polite"></div>
          </div>
          <div class="stat-card">
            <p class="label">Flight Status</p>
            <div id="flightTimeline" class="timeline" aria-live="polite"></div>
          </div>
        </div>
      </div>
    </section>

    <section class="panel" aria-labelledby="history-title" data-screen="history" hidden>
      <div class="panel-header">
        <p id="history-title" class="section-title">Message History</p>
        <p class="section-copy">Local log of every message you‚Äôve launched, saved in your browser.</p>
      </div>
      <div id="historyList" class="history-list" aria-live="polite"></div>
      <p class="tiny">Message history, badges, XP, and your pigeon‚Äôs style never reset. The testing reset clears only today‚Äôs send limit.</p>
    </section>
  </main>

  <footer class="footer">
    <p>Built for cozy daily check-ins. Pixel art, weather-aware routes, and a lot of heart.</p>
  </footer>

  <script src="app.js"></script>
</body>
</html>
